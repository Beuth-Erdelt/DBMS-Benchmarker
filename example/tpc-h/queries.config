{
	'name': "The TPC-H Queries",
	'intro': "This includes the reading queries of TPC-H.",
	'factor': 'mean',
	'connectionmanagement': {
		'timeout': 1200,
		#'numProcesses': 1,
		#'runsPerConnection': 0,
		#'singleConnection': True
	},
	'stream_ordering': {1: [21, 3, 18, 5, 11, 7, 6, 20, 17, 12, 16, 15, 13, 10, 2, 8, 14, 19, 9, 22, 1, 4], 2: [6, 17, 14, 16, 19, 10, 9, 2, 15, 8, 5, 22, 12, 7, 13, 18, 1, 4, 20, 3, 11, 21], 3: [8, 5, 4, 6, 17, 7, 1, 18, 22, 14, 9, 10, 15, 11, 20, 2, 21, 19, 13, 16, 12, 3], 4: [5, 21, 14, 19, 15, 17, 12, 6, 4, 9, 8, 16, 11, 2, 10, 18, 1, 13, 7, 22, 3, 20], 5: [21, 15, 4, 6, 7, 16, 19, 18, 14, 22, 11, 13, 3, 1, 2, 5, 8, 20, 12, 17, 10, 9], 6: [10, 3, 15, 13, 6, 8, 9, 7, 4, 11, 22, 18, 12, 1, 5, 16, 2, 14, 19, 20, 17, 21], 7: [18, 8, 20, 21, 2, 4, 22, 17, 1, 11, 9, 19, 3, 13, 5, 7, 10, 16, 6, 14, 15, 12], 8: [19, 1, 15, 17, 5, 8, 9, 12, 14, 7, 4, 3, 20, 16, 6, 22, 10, 13, 2, 21, 18, 11], 9: [8, 13, 2, 20, 17, 3, 6, 21, 18, 11, 19, 10, 15, 4, 22, 1, 7, 12, 9, 14, 5, 16], 10: [6, 15, 18, 17, 12, 1, 7, 2, 22, 13, 21, 10, 14, 9, 3, 16, 20, 19, 11, 4, 8, 5], 11: [15, 14, 18, 17, 10, 20, 16, 11, 1, 8, 4, 22, 5, 12, 3, 9, 21, 2, 13, 6, 19, 7], 12: [1, 7, 16, 17, 18, 22, 12, 6, 8, 9, 11, 4, 2, 5, 20, 21, 13, 10, 19, 3, 14, 15], 13: [21, 17, 7, 3, 1, 10, 12, 22, 9, 16, 6, 11, 2, 4, 5, 14, 8, 20, 13, 18, 15, 19], 14: [2, 9, 5, 4, 18, 1, 20, 15, 16, 17, 7, 21, 13, 14, 19, 8, 22, 11, 10, 3, 12, 6], 15: [16, 9, 17, 8, 14, 11, 10, 12, 6, 21, 7, 3, 15, 5, 22, 20, 1, 13, 19, 2, 4, 18], 16: [1, 3, 6, 5, 2, 16, 14, 22, 17, 20, 4, 9, 10, 11, 15, 8, 12, 19, 18, 13, 7, 21], 17: [3, 16, 5, 11, 21, 9, 2, 15, 10, 18, 17, 7, 8, 19, 14, 13, 1, 4, 22, 20, 6, 12], 18: [14, 4, 13, 5, 21, 11, 8, 6, 3, 17, 2, 20, 1, 19, 10, 9, 12, 18, 15, 7, 22, 16], 19: [4, 12, 22, 14, 5, 15, 16, 2, 8, 10, 17, 9, 21, 7, 3, 6, 13, 18, 11, 20, 19, 1], 20: [16, 15, 14, 13, 4, 22, 18, 19, 7, 1, 12, 17, 5, 10, 20, 3, 9, 21, 11, 2, 6, 8], 21: [20, 14, 21, 12, 15, 17, 4, 19, 13, 10, 11, 1, 16, 5, 18, 7, 8, 22, 9, 6, 3, 2], 22: [16, 14, 13, 2, 21, 10, 11, 4, 1, 22, 18, 12, 19, 5, 7, 8, 6, 3, 15, 20, 9, 17], 23: [18, 15, 9, 14, 12, 2, 8, 11, 22, 21, 16, 1, 6, 17, 5, 10, 19, 4, 20, 13, 3, 7], 24: [7, 3, 10, 14, 13, 21, 18, 6, 20, 4, 9, 8, 22, 15, 2, 1, 5, 12, 19, 17, 11, 16], 25: [18, 1, 13, 7, 16, 10, 14, 2, 19, 5, 21, 11, 22, 15, 8, 17, 20, 3, 4, 12, 6, 9], 26: [13, 2, 22, 5, 11, 21, 20, 14, 7, 10, 4, 9, 19, 18, 6, 3, 1, 8, 15, 12, 17, 16], 27: [14, 17, 21, 8, 2, 9, 6, 4, 5, 13, 22, 7, 15, 3, 1, 18, 16, 11, 10, 12, 20, 19], 28: [10, 22, 1, 12, 13, 18, 21, 20, 2, 14, 16, 7, 15, 3, 4, 17, 5, 19, 6, 8, 9, 11], 29: [10, 8, 9, 18, 12, 6, 1, 5, 20, 11, 17, 22, 16, 3, 13, 2, 15, 21, 14, 19, 7, 4], 30: [7, 17, 22, 5, 3, 10, 13, 18, 9, 1, 14, 15, 21, 19, 16, 12, 8, 6, 11, 20, 4, 2], 31: [2, 9, 21, 3, 4, 7, 1, 11, 16, 5, 20, 19, 18, 8, 17, 13, 10, 12, 15, 6, 14, 22], 32: [15, 12, 8, 4, 22, 13, 16, 17, 18, 3, 7, 5, 6, 1, 9, 11, 21, 10, 14, 20, 19, 2], 33: [15, 16, 2, 11, 17, 7, 5, 14, 20, 4, 21, 3, 10, 9, 12, 8, 13, 6, 18, 19, 22, 1], 34: [1, 13, 11, 3, 4, 21, 6, 14, 15, 22, 18, 9, 7, 5, 10, 20, 12, 16, 17, 8, 19, 2], 35: [14, 17, 22, 20, 8, 16, 5, 10, 1, 13, 2, 21, 12, 9, 4, 18, 3, 7, 6, 19, 15, 11], 36: [9, 17, 7, 4, 5, 13, 21, 18, 11, 3, 22, 1, 6, 16, 20, 14, 15, 10, 8, 2, 12, 19], 37: [13, 14, 5, 22, 19, 11, 9, 6, 18, 15, 8, 10, 7, 4, 17, 16, 3, 1, 12, 2, 21, 20], 38: [20, 5, 4, 14, 11, 1, 6, 16, 8, 22, 7, 3, 2, 12, 21, 19, 17, 13, 10, 15, 18, 9], 39: [3, 7, 14, 15, 6, 5, 21, 20, 18, 10, 4, 16, 19, 1, 13, 9, 8, 17, 11, 12, 22, 2], 40: [13, 15, 17, 1, 22, 11, 3, 4, 7, 20, 14, 21, 9, 8, 2, 18, 16, 6, 10, 12, 5, 19]},
	'queries':
	[
		{
			'title': "Pricing Summary Report (TPC-H Q1)",
			'query': """select
l_returnflag,
l_linestatus,
cast(sum(l_quantity) as bigint) as sum_qty,
sum(l_extendedprice) as sum_base_price,
sum(l_extendedprice*(1-l_discount)) as sum_disc_price,
sum(l_extendedprice*(1-l_discount)*(1+l_tax)) as sum_charge,
avg(l_quantity) as avg_qty,
avg(l_extendedprice) as avg_price,
avg(l_discount) as avg_disc,
count(*) as count_order
from
lineitem
where
l_shipdate <= date '1998-12-01' - interval '{DELTA}'  day
group by
l_returnflag,
l_linestatus
order by
l_returnflag,
l_linestatus""",
			'DBMS':{
				'MySQL': """select
l_returnflag,
l_linestatus,
cast(sum(l_quantity) as unsigned int) as sum_qty,
sum(l_extendedprice) as sum_base_price,
sum(l_extendedprice*(1-l_discount)) as sum_disc_price,
sum(l_extendedprice*(1-l_discount)*(1+l_tax)) as sum_charge,
avg(l_quantity) as avg_qty,
avg(l_extendedprice) as avg_price,
avg(l_discount) as avg_disc,
count(*) as count_order
from
lineitem
where
l_shipdate <= date('1998-12-01') - interval '{DELTA}'  day
group by
l_returnflag,
l_linestatus
order by
l_returnflag,
l_linestatus
limit 10000000""",
				'TSQL': """select
l_returnflag,
l_linestatus,
cast(sum(l_quantity) as bigint) as sum_qty,
sum(l_extendedprice) as sum_base_price,
sum(l_extendedprice*(1-l_discount)) as sum_disc_price,
sum(l_extendedprice*(1-l_discount)*(1+l_tax)) as sum_charge,
avg(l_quantity) as avg_qty,
avg(l_extendedprice) as avg_price,
avg(l_discount) as avg_disc,
count(*) as count_order
from
lineitem
where
l_shipdate <= dateadd(dd, -{DELTA}, cast('1998-12-01' as date))
group by
l_returnflag,
l_linestatus
order by
l_returnflag,
l_linestatus""",
				'MonetDB': """select
l_returnflag,
l_linestatus,
cast(sum(l_quantity) as bigint) as sum_qty,
sum(l_extendedprice) as sum_base_price,
sum(l_extendedprice*(1-l_discount)) as sum_disc_price,
sum(cast(l_extendedprice*(1-l_discount)*(1+l_tax) as double)) as sum_charge,
avg(l_quantity) as avg_qty,
avg(l_extendedprice) as avg_price,
avg(l_discount) as avg_disc,
count(*) as count_order
from
lineitem
where
l_shipdate <= date '1998-12-01' - interval '{DELTA}'  day
group by
l_returnflag,
l_linestatus
order by
l_returnflag,
l_linestatus""",
				'SAPHANA': """select
l_returnflag,
l_linestatus,
cast(sum(l_quantity) as bigint) as sum_qty,
sum(l_extendedprice) as sum_base_price,
sum(l_extendedprice*(1-l_discount)) as sum_disc_price,
sum(l_extendedprice*(1-l_discount)*(1+l_tax)) as sum_charge,
avg(l_quantity) as avg_qty,
avg(l_extendedprice) as avg_price,
avg(l_discount) as avg_disc,
count(*) as count_order
from
lineitem
where
l_shipdate <= add_days(to_date('1998-12-01'), -{DELTA})
group by
l_returnflag,
l_linestatus
order by
l_returnflag,
l_linestatus""",
				'DB2': """select
l_returnflag,
l_linestatus,
cast(sum(l_quantity) as bigint) as sum_qty,
sum(l_extendedprice) as sum_base_price,
sum(l_extendedprice*(1-l_discount)) as sum_disc_price,
sum(l_extendedprice*(1-l_discount)*(1+l_tax)) as sum_charge,
avg(l_quantity) as avg_qty,
avg(l_extendedprice) as avg_price,
avg(l_discount) as avg_disc,
count(*) as count_order
from
lineitem
where
l_shipdate <= date '1998-12-01' - {DELTA} day
group by
l_returnflag,
l_linestatus
order by
l_returnflag,
l_linestatus""",
			},
			'parameter': {
				'DELTA': {
					'type': "integer",
					'range': [60,99]
				},
			},
			'active': True,
			'numWarmup': 0,
			'numCooldown': 0,
			'numRun': 1,
			'timer':
			{
				'datatransfer':
				{
					'active': True,
					'sorted': True,
					'compare': 'result',
					'store': [],
					'precision': 0,
				},
				'connection':
				{
					'active': True,
				}
			}
		},
		{
			'title': "Minimum Cost Supplier Query (TPC-H Q2)",
			'query': """select
s_acctbal,
s_name,
n_name,
p_partkey,
p_mfgr,
s_address,
s_phone,
s_comment
from
part,
supplier,
partsupp,
nation,
region
where
p_partkey = ps_partkey
and s_suppkey = ps_suppkey
and p_size = {SIZE}
and p_type like '%{TYPE3}'
and s_nationkey = n_nationkey
and n_regionkey = r_regionkey
and r_name = '{REGION}'
and ps_supplycost = (
select min(ps_supplycost)
from
partsupp, supplier,
nation, region
where
p_partkey = ps_partkey
and s_suppkey = ps_suppkey
and s_nationkey = n_nationkey
and n_regionkey = r_regionkey
and r_name = '{REGION}'
)
order by
s_acctbal desc,
n_name,
s_name,
p_partkey
limit 100""",
			'DBMS':{
				'TSQL': """select top 100
s_acctbal,
s_name,
n_name,
p_partkey,
p_mfgr,
s_address,
s_phone,
s_comment
from
part,
supplier,
partsupp,
nation,
region
where
p_partkey = ps_partkey
and s_suppkey = ps_suppkey
and p_size = {SIZE}
and p_type like '%{TYPE3}'
and s_nationkey = n_nationkey
and n_regionkey = r_regionkey
and r_name = '{REGION}'
and ps_supplycost = (
select min(ps_supplycost)
from
partsupp, supplier,
nation, region
where
p_partkey = ps_partkey
and s_suppkey = ps_suppkey
and s_nationkey = n_nationkey
and n_regionkey = r_regionkey
and r_name = '{REGION}'
)
order by
s_acctbal desc,
n_name,
s_name,
p_partkey""",
				'Oracle': """select
s_acctbal,
s_name,
n_name,
p_partkey,
p_mfgr,
s_address,
s_phone,
s_comment
from
part,
supplier,
partsupp,
nation,
region
where
p_partkey = ps_partkey
and s_suppkey = ps_suppkey
and p_size = {SIZE}
and p_type like '%{TYPE3}'
and s_nationkey = n_nationkey
and n_regionkey = r_regionkey
and r_name = '{REGION}'
and ps_supplycost = (
select min(ps_supplycost)
from
partsupp, supplier,
nation, region
where
p_partkey = ps_partkey
and s_suppkey = ps_suppkey
and s_nationkey = n_nationkey
and n_regionkey = r_regionkey
and r_name = '{REGION}'
)
order by
s_acctbal desc,
n_name,
s_name,
p_partkey
fetch next 100 rows only""",
				'OmniSci': """with subquery as
(select
ps_partkey as subq_ps_partkey,
min(ps_supplycost) as min_ps_supplicost
from
partsupp, supplier,
nation, region
where
s_suppkey = ps_suppkey
and s_nationkey = n_nationkey
and n_regionkey = r_regionkey
and r_name = '{REGION}'
group by subq_ps_partkey
)
select
s_acctbal,
s_name,
n_name,
p_partkey,
p_mfgr,
s_address,
s_phone,
s_comment
from
part join
partsupp on p_partkey = ps_partkey join
supplier on s_suppkey = ps_suppkey join
nation on s_nationkey = n_nationkey join
region on n_regionkey = r_regionkey join
subquery on subq_ps_partkey = ps_partkey
where
ps_supplycost = min_ps_supplicost
and p_size = {SIZE}
and p_type like '%{TYPE3}'
and r_name = '{REGION}'
order by
s_acctbal desc,
n_name,
s_name,
p_partkey
limit 100""",
				'Clickhouse': """with subquery as
(select
ps_partkey as subq_ps_partkey,
min(ps_supplycost) as min_ps_supplicost
from
partsupp, supplier,
nation, region
where
s_suppkey = ps_suppkey
and s_nationkey = n_nationkey
and n_regionkey = r_regionkey
and r_name = '{REGION}'
group by subq_ps_partkey
)
select
s_acctbal,
s_name,
n_name,
p_partkey,
p_mfgr,
s_address,
s_phone,
s_comment
from
part join
partsupp on p_partkey = ps_partkey join
supplier on s_suppkey = ps_suppkey join
nation on s_nationkey = n_nationkey join
region on n_regionkey = r_regionkey join
subquery on subq_ps_partkey = ps_partkey
where
ps_supplycost = min_ps_supplicost
and p_size = {SIZE}
and p_type like '%{TYPE3}'
and r_name = '{REGION}'
order by
s_acctbal desc,
n_name,
s_name,
p_partkey
limit 100""",
				'MariaDBCS': """with subquery as
(select
ps_partkey as subq_ps_partkey,
min(ps_supplycost) as min_ps_supplicost
from
partsupp, supplier,
nation, region
where
s_suppkey = ps_suppkey
and s_nationkey = n_nationkey
and n_regionkey = r_regionkey
and r_name = '{REGION}'
group by subq_ps_partkey
)
select
s_acctbal,
s_name,
n_name,
p_partkey,
p_mfgr,
s_address,
s_phone,
s_comment
from
part join
partsupp on p_partkey = ps_partkey join
supplier on s_suppkey = ps_suppkey join
nation on s_nationkey = n_nationkey join
region on n_regionkey = r_regionkey join
subquery on subq_ps_partkey = ps_partkey
where
ps_supplycost = min_ps_supplicost
and p_size = {SIZE}
and p_type like '%{TYPE3}'
and r_name = '{REGION}'
order by
s_acctbal desc,
n_name,
s_name,
p_partkey
limit 100""",
			},
			'parameter': {
				'SIZE': {
					'type': "integer",
					'range': [1,50]
				},
				'TYPE3': {
					'type': "list",
					'range': [" TIN", " NICKEL", " BRASS", " STEEL", " COPPER"]
				},
				'REGION': {
					'type': "list",
					'range': ["AFRICA","AMERICA","ASIA","EUROPE","MIDDLE EAST"]
				},
			},
			'active': True,
			'numWarmup': 0,
			'numCooldown': 0,
			'numRun': 1,
			'timer':
			{
				'datatransfer':
				{
					'active': True,
					'sorted': True,
					'compare': 'result',
					'store': [],
					'precision': 4,
				},
				'connection':
				{
					'active': True,
				}
			}
		},
		{
			'title': "Shipping Priority (TPC-H Q3)",
			'query': """select
l_orderkey,
sum(l_extendedprice*(1-l_discount)) as revenue,
o_orderdate,
o_shippriority
from
customer,
orders,
lineitem
where
c_mktsegment = '{SEGMENT}'
and c_custkey = o_custkey
and l_orderkey = o_orderkey
and o_orderdate < date '{DATE}'
and l_shipdate > date '{DATE}'
group by
l_orderkey,
o_orderdate,
o_shippriority
order by
revenue desc,
o_orderdate
limit 10""",
			'DBMS':{
				'MySQL': """select
l_orderkey,
sum(l_extendedprice*(1-l_discount)) as revenue,
o_orderdate,
o_shippriority
from
customer,
orders,
lineitem
where
c_mktsegment = '{SEGMENT}'
and c_custkey = o_custkey
and l_orderkey = o_orderkey
and o_orderdate < date('{DATE}')
and l_shipdate > date('{DATE}')
group by
l_orderkey,
o_orderdate,
o_shippriority
order by
revenue desc,
o_orderdate
limit 10""",
				'TSQL': """select top 10
l_orderkey,
sum(l_extendedprice*(1-l_discount)) as revenue,
o_orderdate,
o_shippriority
from
customer,
orders,
lineitem
where
c_mktsegment = '{SEGMENT}'
and c_custkey = o_custkey
and l_orderkey = o_orderkey
and o_orderdate < cast('{DATE}' as date)
and l_shipdate > cast('{DATE}' as date)
group by
l_orderkey,
o_orderdate,
o_shippriority
order by
revenue desc,
o_orderdate""",
				'Oracle': """select
l_orderkey,
sum(l_extendedprice*(1-l_discount)) as revenue,
o_orderdate,
o_shippriority
from
customer,
orders,
lineitem
where
c_mktsegment = '{SEGMENT}'
and c_custkey = o_custkey
and l_orderkey = o_orderkey
and o_orderdate < date '{DATE}'
and l_shipdate > date '{DATE}'
group by
l_orderkey,
o_orderdate,
o_shippriority
order by
revenue desc,
o_orderdate
fetch next 10 rows only"""
			},
			'parameter': {
				'SEGMENT': {
					'type': "list",
					'range': ["AUTOMOBILE","BUILDING","FURNITURE","MACHINERY","HOUSEHOLD"]
				},
				'DATE': {
					'type': "date",
					'range': ["1995-03-01","1995-03-31"]
				},
			},
			'active': True,
			'numWarmup': 0,
			'numCooldown': 0,
			'numRun': 1,
			'timer':
			{
				'datatransfer':
				{
					'active': True,
					'sorted': True,
					'compare': 'result',
					'store': [],
					'precision': 4,
				},
				'connection':
				{
					'active': True,
				}
			}
		},
		{
			'title': "Order Priority Checking Query (TPC-H Q4)",
			'query': """select
o_orderpriority,
count(*) as order_count
from
orders
where
o_orderdate >= date '{DATE}'
and o_orderdate < date '{DATE}' + interval '3' month
and exists (
select
*
from
lineitem
where
l_orderkey = o_orderkey
and l_commitdate < l_receiptdate
)
group by
o_orderpriority
order by
o_orderpriority""",
			'DBMS':{
				'MySQL': """select
o_orderpriority,
count(*) as order_count
from
orders
where
o_orderdate >= date('{DATE}')
and o_orderdate < date('{DATE}') + interval '3' month
and exists (
select
*
from
lineitem
where
l_orderkey = o_orderkey
and l_commitdate < l_receiptdate
)
group by
o_orderpriority
order by
o_orderpriority""",
				'TSQL': """select
o_orderpriority,
count(*) as order_count
from
orders
where
o_orderdate >= cast('{DATE}' as date)
and o_orderdate < dateadd(mm, +3, cast('{DATE}' as date))
and exists (
select
*
from
lineitem
where
l_orderkey = o_orderkey
and l_commitdate < l_receiptdate
)
group by
o_orderpriority
order by
o_orderpriority""",
				'SAPHANA': """select
o_orderpriority,
count(*) as order_count
from
orders
where
o_orderdate >= date '{DATE}'
and o_orderdate < add_months(to_date('{DATE}'), 3)
and exists (
select
*
from
lineitem
where
l_orderkey = o_orderkey
and l_commitdate < l_receiptdate
)
group by
o_orderpriority
order by
o_orderpriority""",
				'DB2': """select
o_orderpriority,
count(*) as order_count
from
orders
where
o_orderdate >= date '{DATE}'
and o_orderdate < date '{DATE}' + 3 month
and exists (
select
*
from
lineitem
where
l_orderkey = o_orderkey
and l_commitdate < l_receiptdate
)
group by
o_orderpriority
order by
o_orderpriority""",
				'Citus': """select
o_orderpriority,
count(*) as order_count
from
orders,
lineitem
where
o_orderdate >= date('{DATE}')
and o_orderdate < date('{DATE}') + interval '3' month
and
l_orderkey = o_orderkey
and l_commitdate < l_receiptdate
group by
o_orderpriority
order by
o_orderpriority""",
			},
			'parameter': {
				'DATE': {
					'type': "firstofmonth",
					'range': ["1993-01-01","1997-10-01"]
				},
			},
			'active': True,
			'warmup': 0,
			'numRun': 1,
			'timer':
			{
				'datatransfer':
				{
					'active': True,
					'sorted': True,
					'compare': 'result',
					'store': [],
					'precision': 4,
				},
				'connection':
				{
					'active': True,
				}
			}
		},
		{
			'title': "Local Supplier Volume (TPC-H Q5)",
			'query': """select
n_name,
sum(l_extendedprice * (1 - l_discount)) as revenue
from
customer,
orders,
lineitem,
supplier,
nation,
region
where
c_custkey = o_custkey
and l_orderkey = o_orderkey
and l_suppkey = s_suppkey
and c_nationkey = s_nationkey
and s_nationkey = n_nationkey
and n_regionkey = r_regionkey
and r_name = '{REGION}'
and o_orderdate >= date '{DATE}'
and o_orderdate < date '{DATE}' + interval '1' year
group by
n_name
order by
revenue desc""",
			'DBMS':{
				'MariaDBCS': """select
n_name,
sum(l_extendedprice * (1 - l_discount)) as revenue
from
customer,
orders,
lineitem,
supplier,
nation,
region
where
c_custkey = o_custkey
and l_orderkey = o_orderkey
and l_suppkey = s_suppkey
and c_nationkey = s_nationkey+0
and s_nationkey = n_nationkey
and n_regionkey = r_regionkey
and r_name = '{REGION}'
and o_orderdate >= date '{DATE}'
and o_orderdate < date '{DATE}' + interval '1' year
group by
n_name
order by
revenue desc""",
				'MySQL': """select
n_name,
sum(l_extendedprice * (1 - l_discount)) as revenue
from
customer,
orders,
lineitem,
supplier,
nation,
region
where
c_custkey = o_custkey
and l_orderkey = o_orderkey
and l_suppkey = s_suppkey
and c_nationkey = s_nationkey
and s_nationkey = n_nationkey
and n_regionkey = r_regionkey
and r_name = '{REGION}'
and o_orderdate >= date('{DATE}')
and o_orderdate < date('{DATE}') + interval '1' year
group by
n_name
order by
revenue desc""",
				'TSQL': """select
n_name,
sum(l_extendedprice * (1 - l_discount)) as revenue
from
customer,
orders,
lineitem,
supplier,
nation,
region
where
c_custkey = o_custkey
and l_orderkey = o_orderkey
and l_suppkey = s_suppkey
and c_nationkey = s_nationkey
and s_nationkey = n_nationkey
and n_regionkey = r_regionkey
and r_name = '{REGION}'
and o_orderdate >= cast('{DATE}' as date)
and o_orderdate < dateadd(yy, +1, cast('{DATE}' as date))
group by
n_name
order by
revenue desc""",
				'SAPHANA': """select
n_name,
sum(l_extendedprice * (1 - l_discount)) as revenue
from
customer,
orders,
lineitem,
supplier,
nation,
region
where
c_custkey = o_custkey
and l_orderkey = o_orderkey
and l_suppkey = s_suppkey
and c_nationkey = s_nationkey
and s_nationkey = n_nationkey
and n_regionkey = r_regionkey
and r_name = '{REGION}'
and o_orderdate >= to_date('{DATE}')
and o_orderdate < add_years(to_date('{DATE}'),1)
group by
n_name
order by
revenue desc""",
				'DB2': """select
n_name,
sum(l_extendedprice * (1 - l_discount)) as revenue
from
customer,
orders,
lineitem,
supplier,
nation,
region
where
c_custkey = o_custkey
and l_orderkey = o_orderkey
and l_suppkey = s_suppkey
and c_nationkey = s_nationkey
and s_nationkey = n_nationkey
and n_regionkey = r_regionkey
and r_name = '{REGION}'
and o_orderdate >= date '{DATE}'
and o_orderdate < date '{DATE}' + 1 year
group by
n_name
order by
revenue desc""",
			},
			'parameter': {
				'DATE': {
					'type': "firstofyear",
					'range': [1993, 1997]
				},
				'REGION': {
					'type': "list",
					'range': ["AFRICA","AMERICA","ASIA","EUROPE","MIDDLE EAST"]
				},
			},
			'active': True,
			'numWarmup': 0,
			'numCooldown': 0,
			'numRun': 1,
			'timer':
			{
				'datatransfer':
				{
					'active': True,
					'sorted': True,
					'compare': 'result',
					'store': [],
					'precision': 4,
				},
				'connection':
				{
					'active': True,
				}
			}
		},
		{
			'title': "Forecasting Revenue Change (TPC-H Q6)",
			'query': """select
sum(l_extendedprice*l_discount) as revenue
from
lineitem
where
l_shipdate >= date '{DATE}'
and l_shipdate < date '{DATE}' + interval '1' year
and l_discount between {DISCOUNT} - 0.01 and {DISCOUNT} + 0.01
and l_quantity < {QUANTITY}""",
			'DBMS':{
				'MySQL': """select
sum(l_extendedprice*l_discount) as revenue
from
lineitem
where
l_shipdate >= date('{DATE}')
and l_shipdate < date('{DATE}') + interval '1' year
and l_discount between {DISCOUNT} - 0.01 and {DISCOUNT} + 0.01
and l_quantity < {QUANTITY}""",
				'TSQL': """select
sum(l_extendedprice*l_discount) as revenue
from
lineitem
where
l_shipdate >= cast('{DATE}' as date)
and l_shipdate < dateadd(yy, +1, cast('{DATE}' as date))
and l_discount between {DISCOUNT} - 0.01 and {DISCOUNT} + 0.01
and l_quantity < {QUANTITY}""",
				'SAPHANA': """select
sum(l_extendedprice*l_discount) as revenue
from
lineitem
where
l_shipdate >= to_date('{DATE}')
and l_shipdate < add_years(to_date('{DATE}'),1)
and l_discount between {DISCOUNT} - 0.01 and {DISCOUNT} + 0.01
and l_quantity < {QUANTITY}""",
				'Clickhouse': """select
sum(l_extendedprice*l_discount) as revenue
from
lineitem
where
l_shipdate >= toDate('{DATE}')
and l_shipdate < addYears(toDate('{DATE}'),1)
and l_discount between CAST({DISCOUNT} - 0.01 AS Decimal(16, 2)) and CAST({DISCOUNT} + 0.01 AS Decimal(16, 2))
and l_quantity < {QUANTITY}""",
				'DB2': """select
sum(l_extendedprice*l_discount) as revenue
from
lineitem
where
l_shipdate >= date '{DATE}'
and l_shipdate < date '{DATE}' + 1 year
and l_discount between {DISCOUNT} - 0.01 and {DISCOUNT} + 0.01
and l_quantity < {QUANTITY}""",
			},
			'parameter': {
				'DATE': {
					'type': "firstofyear",
					'range': [1993, 1997]
				},
				'DISCOUNT': {
					'type': "float",
					'range': [0.02, 0.09]
				},
				'QUANTITY': {
					'type': "integer",
					'range': [24,25]
				},
			},
			'active': True,
			'numWarmup': 0,
			'numCooldown': 0,
			'numRun': 1,
			'timer':
			{
				'datatransfer':
				{
					'active': True,
					'sorted': True,
					'compare': 'result',
					'store': [],
					'precision': 4,
				},
				'connection':
				{
					'active': True,
				}
			}
		},
		{
			'title': "Forecasting Revenue Change (TPC-H Q7)",
			'query': """select
supp_nation,
cust_nation,
l_year, sum(volume) as revenue
from (
select
n1.n_name as supp_nation,
n2.n_name as cust_nation,
cast(extract(year from l_shipdate) as int) as l_year,
l_extendedprice * (1 - l_discount) as volume
from
supplier,
lineitem,
orders,
customer,
nation n1,
nation n2
where
s_suppkey = l_suppkey
and o_orderkey = l_orderkey
and c_custkey = o_custkey
and s_nationkey = n1.n_nationkey
and c_nationkey = n2.n_nationkey
and (
(n1.n_name = '{NATION1}' and n2.n_name = '{NATION2}')
or (n1.n_name = '{NATION2}' and n2.n_name = '{NATION1}')
)
and l_shipdate between date '1995-01-01' and date '1996-12-31'
) shipping
group by
supp_nation,
cust_nation,
l_year
order by
supp_nation,
cust_nation,
l_year""",
			'DBMS':{
				'MySQL': """select
supp_nation,
cust_nation,
l_year, sum(volume) as revenue
from (
select
n1.n_name as supp_nation,
n2.n_name as cust_nation,
extract(year from l_shipdate) as l_year,
l_extendedprice * (1 - l_discount) as volume
from
supplier,
lineitem,
orders,
customer,
nation n1,
nation n2
where
s_suppkey = l_suppkey
and o_orderkey = l_orderkey
and c_custkey = o_custkey
and s_nationkey = n1.n_nationkey
and c_nationkey = n2.n_nationkey
and (
(n1.n_name = '{NATION1}' and n2.n_name = '{NATION2}')
or (n1.n_name = '{NATION2}' and n2.n_name = '{NATION1}')
)
and l_shipdate between date('1995-01-01') and date('1996-12-31')
) as shipping
group by
supp_nation,
cust_nation,
l_year
order by
supp_nation,
cust_nation,
l_year""",
				'TSQL': """select
supp_nation,
cust_nation,
l_year, sum(volume) as revenue
from (
select
n1.n_name as supp_nation,
n2.n_name as cust_nation,
cast(year(l_shipdate) as int) as l_year,
l_extendedprice * (1 - l_discount) as volume
from
supplier,
lineitem,
orders,
customer,
nation n1,
nation n2
where
s_suppkey = l_suppkey
and o_orderkey = l_orderkey
and c_custkey = o_custkey
and s_nationkey = n1.n_nationkey
and c_nationkey = n2.n_nationkey
and (
(n1.n_name = '{NATION1}' and n2.n_name = '{NATION2}')
or (n1.n_name = '{NATION2}' and n2.n_name = '{NATION1}')
)
and l_shipdate between cast('1995-01-01' as date) and cast('1996-12-31' as date)
) as shipping
group by
supp_nation,
cust_nation,
l_year
order by
supp_nation,
cust_nation,
l_year
"""
			},
			'parameter': {
				'NATION': {
					'type': "list",
					'size': 2,
					'range': ["ALGERIA","ARGENTINA","BRAZIL","CANADA","INDIA","INDONESIA","IRAN","IRAQ","MOZAMBIQUE","PERU","CHINA","ROMANIA","UNITED STATES","EGYPT","ETHIOPIA","FRANCE","GERMANY","JAPAN","JORDAN","KENYA","MOROCCO","SAUDI ARABIA","VIETNAM","RUSSIA","UNITED KINGDOM"]
				},
			},
			'active': True,
			'numWarmup': 0,
			'numCooldown': 0,
			'numRun': 1,
			'timer':
			{
				'datatransfer':
				{
					'active': True,
					'sorted': True,
					'compare': 'result',
					'store': [],
					'precision': 4,
				},
				'connection':
				{
					'active': True,
				}
			}
		},
		{
			'title': "National Market Share (TPC-H Q8)",
			'query': """select
o_year,
sum(case
when nation = '{NATIONREGION2}'
then volume
else 0
end) / sum(volume) as mkt_share
from (
select
cast(extract(year from o_orderdate) as int) as o_year,
cast(l_extendedprice as double) * (1-l_discount) as volume,
n2.n_name as nation
from
part,
supplier,
lineitem,
orders,
customer,
nation n1,
nation n2,
region
where
p_partkey = l_partkey
and s_suppkey = l_suppkey
and l_orderkey = o_orderkey
and o_custkey = c_custkey
and c_nationkey = n1.n_nationkey
and n1.n_regionkey = r_regionkey
and r_name = '{NATIONREGION1}'
and s_nationkey = n2.n_nationkey
and o_orderdate between date '1995-01-01' and date '1996-12-31'
and p_type = '{TYPE1}{TYPE2}{TYPE3}'
) all_nations
group by
o_year
order by
o_year""",
			'DBMS':{
				'MySQL': """select
o_year,
sum(case
when nation = '{NATIONREGION2}'
then volume
else 0
end) / sum(volume) as mkt_share
from (
select
cast(extract(year from o_orderdate) as unsigned) as o_year,
l_extendedprice * (1-l_discount) as volume,
n2.n_name as nation
from
part,
supplier,
lineitem,
orders,
customer,
nation n1,
nation n2,
region
where
p_partkey = l_partkey
and s_suppkey = l_suppkey
and l_orderkey = o_orderkey
and o_custkey = c_custkey
and c_nationkey = n1.n_nationkey
and n1.n_regionkey = r_regionkey
and r_name = '{NATIONREGION1}'
and s_nationkey = n2.n_nationkey
and o_orderdate between date('1995-01-01') and date('1996-12-31')
and p_type = '{TYPE1}{TYPE2}{TYPE3}'
) as all_nations
group by
o_year
order by
o_year""",
				'Citus': """select
o_year,
sum(case
when nation = '{NATIONREGION2}'
then volume
else 0
end) / sum(volume) as mkt_share
from (
select
cast(extract(year from o_orderdate) as integer) as o_year,
cast(l_extendedprice as double precision) * (1-l_discount) as volume,
n2.n_name as nation
from
part,
supplier,
lineitem,
orders,
customer,
nation n1,
nation n2,
region
where
p_partkey = l_partkey
and s_suppkey = l_suppkey
and l_orderkey = o_orderkey
and o_custkey = c_custkey
and c_nationkey = n1.n_nationkey
and n1.n_regionkey = r_regionkey
and r_name = '{NATIONREGION1}'
and s_nationkey = n2.n_nationkey
and o_orderdate between date('1995-01-01') and date('1996-12-31')
and p_type = '{TYPE1}{TYPE2}{TYPE3}'
) as all_nations
group by
o_year
order by
o_year""",
				'PostgreSQL': """select
o_year,
sum(case
when nation = '{NATIONREGION2}'
then volume
else 0
end) / sum(volume) as mkt_share
from (
select
cast(extract(year from o_orderdate) as integer) as o_year,
cast(l_extendedprice as double precision) * (1-l_discount) as volume,
n2.n_name as nation
from
part,
supplier,
lineitem,
orders,
customer,
nation n1,
nation n2,
region
where
p_partkey = l_partkey
and s_suppkey = l_suppkey
and l_orderkey = o_orderkey
and o_custkey = c_custkey
and c_nationkey = n1.n_nationkey
and n1.n_regionkey = r_regionkey
and r_name = '{NATIONREGION1}'
and s_nationkey = n2.n_nationkey
and o_orderdate between date('1995-01-01') and date('1996-12-31')
and p_type = '{TYPE1}{TYPE2}{TYPE3}'
) as all_nations
group by
o_year
order by
o_year""",
				'TSQL': """select
o_year,
sum(case
when nation = '{NATIONREGION2}'
then volume
else 0
end) / sum(volume) as mkt_share
from (
select
cast(year(o_orderdate) as int) as o_year,
l_extendedprice * (1-l_discount) as volume,
n2.n_name as nation
from
part,
supplier,
lineitem,
orders,
customer,
nation n1,
nation n2,
region
where
p_partkey = l_partkey
and s_suppkey = l_suppkey
and l_orderkey = o_orderkey
and o_custkey = c_custkey
and c_nationkey = n1.n_nationkey
and n1.n_regionkey = r_regionkey
and r_name = '{NATIONREGION1}'
and s_nationkey = n2.n_nationkey
and o_orderdate between cast('1995-01-01' as date) and cast('1996-12-31' as date)
and p_type = '{TYPE1}{TYPE2}{TYPE3}'
) as all_nations
group by
o_year
order by
o_year""",
			},
			'parameter': {
				'NATION': {
					'type': "list",
					'range': ["ALGERIA","ARGENTINA","BRAZIL","CANADA","INDIA","INDONESIA","IRAN","IRAQ","MOZAMBIQUE","PERU","CHINA","ROMANIA","UNITED STATES","EGYPT","ETHIOPIA","FRANCE","GERMANY","JAPAN","JORDAN","KENYA","MOROCCO","SAUDI ARABIA","VIETNAM","RUSSIA","UNITED KINGDOM"]
				},
				'TYPE1': {
					'type': "list",
					'range': ["STANDARD", "SMALL", "MEDIUM", "LARGE", "ECONOMY", "PROMO"]
				},
				'TYPE2': {
					'type': "list",
					'range': [" ANODIZED", " BURNISHED", " PLATED", " POLISHED", " BRUSHED"]
				},
				'TYPE3': {
					'type': "list",
					'range': [" TIN", " NICKEL", " BRASS", " STEEL", " COPPER"]
				},
				'REGION': {
					'type': "list",
					'range': ["AFRICA","AMERICA","ASIA","EUROPE","MIDDLE EAST"]
				},
				'NATIONREGION': {
					'type': "dict",
					'range': {"AFRICA": ["MOROCCO", "ALGERIA", "MOZAMBIQUE", "ETHIOPIA", "KENYA"],
"AMERICA": ["CANADA", "UNITED STATES", "ARGENTINA", "PERU", "BRAZIL"],
"ASIA": ["INDIA", "JAPAN", "INDONESIA", "VIETNAM", "CHINA"],
"EUROPE": ["GERMANY", "ROMANIA", "UNITED KINGDOM", "FRANCE", "RUSSIA"],
"MIDDLE EAST": ["IRAQ", "EGYPT", "SAUDI ARABIA", "JORDAN", "IRAN"]}
				},
			},
			'active': True,
			'numWarmup': 0,
			'numCooldown': 0,
			'numRun': 1,
			'timer':
			{
				'datatransfer':
				{
					'active': True,
					'sorted': True,
					'compare': 'result',
					'store': [],
					'precision': 2,
				},
				'connection':
				{
					'active': True,
				}
			}
		},
		{
			'title': "Product Type Profit Measure (TPC-H Q9)",
			'query': """select
nation,
o_year,
sum(amount) as sum_profit
from (
select
n_name as nation,
cast(extract(year from o_orderdate) as int)as o_year,
l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
from
part,
supplier,
lineitem,
partsupp,
orders,
nation
where
s_suppkey = l_suppkey
and ps_suppkey = l_suppkey
and ps_partkey = l_partkey
and p_partkey = l_partkey
and o_orderkey = l_orderkey
and s_nationkey = n_nationkey
and p_name like '%{COLOR}%'
) profit
group by
nation,
o_year
order by
nation,
o_year desc""",
			'DBMS':{
				'MySQL': """select
nation,
o_year,
sum(amount) as sum_profit
from (
select
n_name as nation,
extract(year from o_orderdate) as o_year,
l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
from
part,
supplier,
lineitem,
partsupp,
orders,
nation
where
s_suppkey = l_suppkey
and ps_suppkey = l_suppkey
and ps_partkey = l_partkey
and p_partkey = l_partkey
and o_orderkey = l_orderkey
and s_nationkey = n_nationkey
and p_name like '%{COLOR}%'
) as profit
group by
nation,
o_year
order by
nation,
o_year desc""",
				'TSQL': """select
nation,
o_year,
sum(amount) as sum_profit
from (
select
n_name as nation,
cast(year(o_orderdate) as int)as o_year,
l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
from
part,
supplier,
lineitem,
partsupp,
orders,
nation
where
s_suppkey = l_suppkey
and ps_suppkey = l_suppkey
and ps_partkey = l_partkey
and p_partkey = l_partkey
and o_orderkey = l_orderkey
and s_nationkey = n_nationkey
and p_name like '%{COLOR}%'
) as profit
group by
nation,
o_year
order by
nation,
o_year desc""",
				'OmniSci': """select
nation,
o_year,
cast(sum(amount) as double) as sum_profit
from (
select
n_name as nation,
extract(year from o_orderdate) as o_year,
cast(l_extendedprice as double) * (1 - l_discount) - cast(ps_supplycost as double) * l_quantity as amount
from
part,
supplier,
lineitem,
partsupp,
orders,
nation
where
s_suppkey = l_suppkey
and ps_suppkey = l_suppkey
and ps_partkey = l_partkey
and p_partkey = l_partkey
and o_orderkey = l_orderkey
and s_nationkey = n_nationkey
and p_name like '%{COLOR}%'
) as profit
group by
nation,
o_year
order by
nation,
o_year desc""",
				'Citus': """select
nation,
o_year,
cast(sum(amount) as double) as sum_profit
from (
select
n_name as nation,
extract(year from o_orderdate) as o_year,
cast(l_extendedprice as double) * (1 - l_discount) - cast(ps_supplycost as double precision) * l_quantity as amount
from
part,
supplier,
lineitem,
partsupp,
orders,
nation
where
s_suppkey = l_suppkey
and ps_suppkey = l_suppkey
and ps_partkey = l_partkey
and p_partkey = l_partkey
and o_orderkey = l_orderkey
and s_nationkey = n_nationkey
and p_name like '%{COLOR}%'
) as profit
group by
nation,
o_year
order by
nation,
o_year desc""",
			},
			'parameter': {
				'COLOR': {
					'type': "list",
					'range': ["almond", "antique", "aquamarine", "azure", "beige", "bisque", "black", "blanched", "blue", "blush", "brown", "burlywood", "burnished", "chartreuse", "chiffon", "chocolate", "coral", "cornflower", "cornsilk", "cream", "cyan", "dark", "deep", "dim", "dodger", "drab", "firebrick", "floral", "forest", "frosted", "gainsboro", "ghost", "goldenrod", "green", "grey", "honeydew", "hot", "indian", "ivory", "khaki", "lace", "lavender", "lawn", "lemon", "light", "lime", "linen", "magenta", "maroon", "medium", "metallic", "midnight", "mint", "misty", "moccasin", "navajo", "navy", "olive", "orange", "orchid", "pale", "papaya", "peach", "peru", "pink", "plum", "powder", "puff", "purple", "red", "rose", "rosy", "royal", "saddle", "salmon", "sandy", "seashell", "sienna", "sky", "slate", "smoke", "snow", "spring", "steel", "tan", "thistle", "tomato", "turquoise", "violet", "wheat", "white", "yellow"]
				},
			},
			'active': True,
			'numWarmup': 0,
			'numCooldown': 0,
			'numRun': 1,
			'timer':
			{
				'datatransfer':
				{
					'active': True,
					'sorted': True,
					'compare': 'result',
					'store': [],
					'precision': 4,
				},
				'connection':
				{
					'active': True,
				}
			}
		},
		{
			'title': "Forecasting Revenue Change (TPC-H Q10)",
			'query': """select
c_custkey,
c_name,
sum(cast(l_extendedprice * (1 - l_discount) as double)) as revenue,
c_acctbal,
n_name,
c_address,
c_phone,
c_comment
from
customer,
orders,
lineitem,
nation
where
c_custkey = o_custkey
and l_orderkey = o_orderkey
and o_orderdate >= date '{DATE}'
and o_orderdate < date '{DATE}' + interval '3' month
and l_returnflag = 'R'
and c_nationkey = n_nationkey
group by
c_custkey,
c_name,
c_acctbal,
c_phone,
n_name,
c_address,
c_comment
order by
revenue desc
limit 20""",
			'DBMS':{
				'MySQL': """select
c_custkey,
c_name,
sum(l_extendedprice * (1 - l_discount)) as revenue,
c_acctbal,
n_name,
c_address,
c_phone,
c_comment
from
customer,
orders,
lineitem,
nation
where
c_custkey = o_custkey
and l_orderkey = o_orderkey
and o_orderdate >= date('{DATE}')
and o_orderdate < date('{DATE}') + interval '3' month
and l_returnflag = 'R'
and c_nationkey = n_nationkey
group by
c_custkey,
c_name,
c_acctbal,
c_phone,
n_name,
c_address,
c_comment
order by
revenue desc
limit 20""",
				'Citus': """select
c_custkey,
c_name,
sum(cast(l_extendedprice * (1 - l_discount) as double precision)) as revenue,
c_acctbal,
n_name,
c_address,
c_phone,
c_comment
from
customer,
orders,
lineitem,
nation
where
c_custkey = o_custkey
and l_orderkey = o_orderkey
and o_orderdate >= date('{DATE}')
and o_orderdate < date('{DATE}') + interval '3' month
and l_returnflag = 'R'
and c_nationkey = n_nationkey
group by
c_custkey,
c_name,
c_acctbal,
c_phone,
n_name,
c_address,
c_comment
order by
revenue desc
limit 20""",
				'PostgreSQL': """select
c_custkey,
c_name,
sum(cast(l_extendedprice * (1 - l_discount) as double precision)) as revenue,
c_acctbal,
n_name,
c_address,
c_phone,
c_comment
from
customer,
orders,
lineitem,
nation
where
c_custkey = o_custkey
and l_orderkey = o_orderkey
and o_orderdate >= date('{DATE}')
and o_orderdate < date('{DATE}') + interval '3' month
and l_returnflag = 'R'
and c_nationkey = n_nationkey
group by
c_custkey,
c_name,
c_acctbal,
c_phone,
n_name,
c_address,
c_comment
order by
revenue desc
limit 20""",
				'TSQL': """select top 20
c_custkey,
c_name,
sum(l_extendedprice * (1 - l_discount)) as revenue,
c_acctbal,
n_name,
c_address,
c_phone,
c_comment
from
customer,
orders,
lineitem,
nation
where
c_custkey = o_custkey
and l_orderkey = o_orderkey
and o_orderdate >= cast('{DATE}' as date)
and o_orderdate < dateadd(mm, +3, cast('{DATE}' as date))
and l_returnflag = 'R'
and c_nationkey = n_nationkey
group by
c_custkey,
c_name,
c_acctbal,
c_phone,
n_name,
c_address,
c_comment
order by
revenue desc""",
				'Oracle': """select
c_custkey,
c_name,
sum(l_extendedprice * (1 - l_discount)) as revenue,
c_acctbal,
n_name,
c_address,
c_phone,
c_comment
from
customer,
orders,
lineitem,
nation
where
c_custkey = o_custkey
and l_orderkey = o_orderkey
and o_orderdate >= date '{DATE}'
and o_orderdate < date '{DATE}' + interval '3' month
and l_returnflag = 'R'
and c_nationkey = n_nationkey
group by
c_custkey,
c_name,
c_acctbal,
c_phone,
n_name,
c_address,
c_comment
order by
revenue desc
fetch next 20 rows only""",
				'SAPHANA': """select
c_custkey,
c_name,
sum(l_extendedprice * (1 - l_discount)) as revenue,
c_acctbal,
n_name,
c_address,
c_phone,
c_comment
from
customer,
orders,
lineitem,
nation
where
c_custkey = o_custkey
and l_orderkey = o_orderkey
and o_orderdate >= to_date('{DATE}')
and o_orderdate < add_months(to_date('{DATE}'),3)
and l_returnflag = 'R'
and c_nationkey = n_nationkey
group by
c_custkey,
c_name,
c_acctbal,
c_phone,
n_name,
c_address,
c_comment
order by
revenue desc
limit 20""",
				'DB2': """select
c_custkey,
c_name,
sum(cast(l_extendedprice * (1 - l_discount) as double)) as revenue,
c_acctbal,
n_name,
c_address,
c_phone,
c_comment
from
customer,
orders,
lineitem,
nation
where
c_custkey = o_custkey
and l_orderkey = o_orderkey
and o_orderdate >= date '{DATE}'
and o_orderdate < date '{DATE}' + 3 month
and l_returnflag = 'R'
and c_nationkey = n_nationkey
group by
c_custkey,
c_name,
c_acctbal,
c_phone,
n_name,
c_address,
c_comment
order by
revenue desc
limit 20""",
			},
			'parameter': {
				'DATE': {
					'type': "firstofmonth",
					'range': ["1993-02-01", "1995-01-01"]
				},
			},
			'active': True,
			'numWarmup': 0,
			'numCooldown': 0,
			'numRun': 1,
			'timer':
			{
				'datatransfer':
				{
					'active': True,
					'sorted': True,
					'compare': 'result',
					'store': [],
					'precision': 4,
				},
				'connection':
				{
					'active': True,
				}
			}
		},
		{
			'title': "Important Stock Identification (TPC-H Q11)",
			'query': """select
ps_partkey,
sum(ps_supplycost * ps_availqty) as v
from
partsupp,
supplier,
nation
where
ps_suppkey = s_suppkey
and s_nationkey = n_nationkey
and n_name = '{NATION}'
group by
ps_partkey having
sum(ps_supplycost * ps_availqty) > (
select
sum(ps_supplycost * ps_availqty) * {FRACTION} * (1.0 / {SF}.0)
from
partsupp,
supplier,
nation
where
ps_suppkey = s_suppkey
and s_nationkey = n_nationkey
and n_name = '{NATION}'
)
order by
v desc""",
			'DBMS':{
				'Clickhouse': """select
ps_partkey,
sum(ps_supplycost * ps_availqty) as v
from
partsupp,
supplier,
nation
where
ps_suppkey = s_suppkey
and s_nationkey = n_nationkey
and n_name = '{NATION}'
group by
ps_partkey having
cast(sum(ps_supplycost * ps_availqty)as Float64  ) > (
select
cast(sum(ps_supplycost * ps_availqty)as Float64  ) * {FRACTION} * (1.0 / {SF}.0) 
from
partsupp,
supplier,
nation
where
ps_suppkey = s_suppkey
and s_nationkey = n_nationkey
and n_name = '{NATION}'
)
order by
v desc""",
				'DB2': """select
ps_partkey,
cast(sum(ps_supplycost * ps_availqty)as double  ) as v
from
partsupp,
supplier,
nation
where
ps_suppkey = s_suppkey
and s_nationkey = n_nationkey
and n_name = '{NATION}'
group by
ps_partkey having
cast(sum(ps_supplycost * ps_availqty)as double  ) > (
select
cast(sum(ps_supplycost * ps_availqty)as double  ) * {FRACTION} * (1.0 / {SF}.0) 
from
partsupp,
supplier,
nation
where
ps_suppkey = s_suppkey
and s_nationkey = n_nationkey
and n_name = '{NATION}'
)
order by
v desc""",
			},
			'parameter': {
				'NATION': {
					'type': "list",
					'range': ["ALGERIA","ARGENTINA","BRAZIL","CANADA","INDIA","INDONESIA","IRAN","IRAQ","MOZAMBIQUE","PERU","CHINA","ROMANIA","UNITED STATES","EGYPT","ETHIOPIA","FRANCE","GERMANY","JAPAN","JORDAN","KENYA","MOROCCO","SAUDI ARABIA","VIETNAM","RUSSIA","UNITED KINGDOM"]
				},
				'FRACTION': {
					'type': "list",
					'range': [0.0001]
				},
				'SF': {
					'type': "list",
					'range': [1]
				},
			},
			'active': True,
			'numWarmup': 0,
			'numCooldown': 0,
			'numRun': 1,
			'timer':
			{
				'datatransfer':
				{
					'active': True,
					'sorted': True,
					'compare': 'result',
					'store': [],
					'precision': 4,
				},
				'connection':
				{
					'active': True,
				}
			}
		},
		{
			'title': "Shipping Modes and Order Priority (TPC-H Q12)",
			'query': """select
l_shipmode,
sum(case
when o_orderpriority ='1-URGENT'
or o_orderpriority ='2-HIGH'
then 1.0
else 0.0
end) as high_line_count,
sum(case
when o_orderpriority <> '1-URGENT'
and o_orderpriority <> '2-HIGH'
then 1.0
else 0.0
end) as low_line_count
from
orders,
lineitem
where
o_orderkey = l_orderkey
and l_shipmode in ('{SHIPMODE1}', '{SHIPMODE2}')
and l_commitdate < l_receiptdate
and l_shipdate < l_commitdate
and l_receiptdate >= date '{DATE}'
and l_receiptdate < date '{DATE}' + interval '1' year
group by
l_shipmode
order by
l_shipmode""",
			'DBMS':{
				'MySQL': """select
l_shipmode,
sum(case
when o_orderpriority ='1-URGENT'
or o_orderpriority ='2-HIGH'
then 1.0
else 0.0
end) as high_line_count,
sum(case
when o_orderpriority <> '1-URGENT'
and o_orderpriority <> '2-HIGH'
then 1.0
else 0.0
end) as low_line_count
from
orders,
lineitem
where
o_orderkey = l_orderkey
and l_shipmode in ('{SHIPMODE1}', '{SHIPMODE2}')
and l_commitdate < l_receiptdate
and l_shipdate < l_commitdate
and l_receiptdate >= date('{DATE}')
and l_receiptdate < date('{DATE}') + interval '1' year
group by
l_shipmode
order by
l_shipmode""",
				'TSQL': """select
l_shipmode,
sum(case
when o_orderpriority ='1-URGENT'
or o_orderpriority ='2-HIGH'
then 1.0
else 0.0
end) as high_line_count,
sum(case
when o_orderpriority <> '1-URGENT'
and o_orderpriority <> '2-HIGH'
then 1.0
else 0.0
end) as low_line_count
from
orders,
lineitem
where
o_orderkey = l_orderkey
and l_shipmode in ('{SHIPMODE1}', '{SHIPMODE2}')
and l_commitdate < l_receiptdate
and l_shipdate < l_commitdate
and l_receiptdate >= cast('{DATE}' as date)
and l_receiptdate < dateadd(yy, +1, cast('{DATE}' as date))
group by
l_shipmode
order by
l_shipmode""",
				'SAPHANA': """select
l_shipmode,
sum(case
when o_orderpriority ='1-URGENT'
or o_orderpriority ='2-HIGH'
then 1.0
else 0.0
end) as high_line_count,
sum(case
when o_orderpriority <> '1-URGENT'
and o_orderpriority <> '2-HIGH'
then 1.0
else 0.0
end) as low_line_count
from
orders,
lineitem
where
o_orderkey = l_orderkey
and l_shipmode in ('{SHIPMODE1}', '{SHIPMODE2}')
and l_commitdate < l_receiptdate
and l_shipdate < l_commitdate
and l_receiptdate >= to_date('{DATE}')
and l_receiptdate < add_years(to_date('{DATE}'),1)
group by
l_shipmode
order by
l_shipmode""",
				'DB2': """select
l_shipmode,
sum(case
when o_orderpriority ='1-URGENT'
or o_orderpriority ='2-HIGH'
then 1.0
else 0.0
end) as high_line_count,
sum(case
when o_orderpriority <> '1-URGENT'
and o_orderpriority <> '2-HIGH'
then 1.0
else 0.0
end) as low_line_count
from
orders,
lineitem
where
o_orderkey = l_orderkey
and l_shipmode in ('{SHIPMODE1}', '{SHIPMODE2}')
and l_commitdate < l_receiptdate
and l_shipdate < l_commitdate
and l_receiptdate >= date '{DATE}'
and l_receiptdate < date '{DATE}' + 1 year
group by
l_shipmode
order by
l_shipmode""",
			},
			'parameter': {
				'SHIPMODE': {
					'type': "list",
					'size': 2,
					'range': ["REG AIR","AIR","RAIL","SHIP","TRUCK","MAIL","FOB"]
				},
				'DATE': {
					'type': "firstofyear",
					'range': [1993, 1997]
				},
			},
			'active': True,
			'numWarmup': 0,
			'numCooldown': 0,
			'numRun': 1,
			'timer':
			{
				'datatransfer':
				{
					'active': True,
					'sorted': True,
					'compare': 'result',
					'store': [],
					'precision': 4,
				},
				'connection':
				{
					'active': True,
				}
			}
		},
		{
			'title': "Customer Distribution (TPC-H Q13)",
			'query': """select
c_count, count(*) as custdist
from (
select
c_custkey c_custkey,
count(o_orderkey) c_count
from
customer left outer join orders on
c_custkey = o_custkey
where o_comment not like '%{WORD1}%{WORD2}%'
group by
c_custkey
) c_orders
group by
c_count
order by
custdist desc,
c_count desc""",
			'parameter': {
				'WORD1': {
					'type': "list",
					'range': ["special", "pending", "unusual", "express"]
				},
				'WORD2': {
					'type': "list",
					'range': ["packages", "requests", "accounts", "deposits"]
				},
			},
			'active': True,
			'numWarmup': 0,
			'numCooldown': 0,
			'numRun': 1,
			'timer':
			{
				'datatransfer':
				{
					'active': True,
					'sorted': True,
					'compare': 'result',
					'store': [],
					'precision': 4,
				},
				'connection':
				{
					'active': True,
				}
			}
		},
		{
			'title': "Forecasting Revenue Change (TPC-H Q14)",
			'query': """select
100.00 * sum(case
when p_type like 'PROMO%'
then l_extendedprice*(1-l_discount)
else 0
end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue
from
lineitem,
part
where
l_partkey = p_partkey
and l_shipdate >= date '{DATE}'
and l_shipdate < date '{DATE}' + interval '1' month""",
			'DBMS':{
				'MySQL': """select
100.00 * sum(case
when p_type like 'PROMO%'
then l_extendedprice*(1-l_discount)
else 0
end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue
from
lineitem,
part
where
l_partkey = p_partkey
and l_shipdate >= date( '{DATE}')
and l_shipdate < date('{DATE}') + interval '1' month""",
				'TSQL': """select
100.00 * sum(case
when p_type like 'PROMO%'
then l_extendedprice*(1-l_discount)
else 0
end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue
from
lineitem,
part
where
l_partkey = p_partkey
and l_shipdate >= cast('{DATE}' as date)
and l_shipdate < dateadd(mm, +1, cast('{DATE}' as date))""",
				'OmniSci': """select
  100.00 * sum(
    case
      when p_type like 'PROMO%' then cast(l_extendedprice as FLOAT) * (1 - l_discount)
      else 0
    end
  ) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue
from
  lineitem,
  part
where
  l_partkey = p_partkey
  and l_shipdate >= date '{DATE}'
  and l_shipdate < date '{DATE}' + interval '1' month""",
				'MonetDB': """select
  100.00 * CAST(sum(
    case
      when p_type like 'PROMO%' then cast(l_extendedprice as FLOAT) * (1 - l_discount)
      else 0
    end
  ) AS double) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue
from
  lineitem,
  part
where
  l_partkey = p_partkey
  and l_shipdate >= date '{DATE}'
  and l_shipdate < date '{DATE}' + interval '1' month""",
				'SAPHANA': """select
100.00 * sum(case
when p_type like 'PROMO%'
then l_extendedprice*(1-l_discount)
else 0
end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue
from
lineitem,
part
where
l_partkey = p_partkey
and l_shipdate >= to_date('{DATE}')
and l_shipdate < add_months(to_date('{DATE}'),1)""",
				'Clickhouse': """select
  100.00 * CAST(sum(
    case
      when p_type like 'PROMO%' then cast(l_extendedprice as Float64) * (1 - l_discount)
      else 0
    end
  ) AS Float64) / CAST(sum(l_extendedprice * (1 - l_discount)) AS Float64) as promo_revenue
from
  lineitem,
  part
where
  l_partkey = p_partkey
  and l_shipdate >= date '{DATE}'
  and l_shipdate < date '{DATE}' + interval '1' month""",
				'DB2': """select
100.00 * sum(case
when p_type like 'PROMO%'
then l_extendedprice*(1-l_discount)
else 0
end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue
from
lineitem,
part
where
l_partkey = p_partkey
and l_shipdate >= date '{DATE}'
and l_shipdate < date '{DATE}' + 1 month""",
			},
			'parameter': {
				'DATE': {
					'type': "firstofmonth",
					'range': ["1993-01-01", "1997-01-01"]
				},
			},
			'active': True,
			'numWarmup': 0,
			'numCooldown': 0,
			'numRun': 1,
			'timer':
			{
				'datatransfer':
				{
					'active': True,
					'sorted': True,
					'compare': 'result',
					'store': [],
					'precision': 4,
				},
				'connection':
				{
					'active': True,
				}
			}
		},
		{
			'title': "Top Supplier Query (TPC-H Q15)",
			'query': """with revenue (supplier_no, total_revenue) as (
select
l_suppkey,
sum(l_extendedprice * (1-l_discount))
from
lineitem
where
l_shipdate >= date('{DATE}')
and l_shipdate < date('{DATE}') + interval '3' month
group by
l_suppkey)
select
s_suppkey,
s_name,
s_address,
s_phone,
total_revenue
from
supplier,
revenue
where
s_suppkey = supplier_no
and total_revenue = (
select
max(total_revenue)
from
revenue
)
order by
s_suppkey""",
			'DBMS':{
				'Original_view': ["""create view revenue{numRun}{STREAM} as
select
l_suppkey supplier_no,
sum(l_extendedprice * (1 - l_discount)) total_revenue
from
lineitem
where
l_shipdate >= date '{DATE}'
and l_shipdate < date '{DATE}' + interval '3' month
group by
l_suppkey""",
"""select
s_suppkey,
s_name,
s_address,
s_phone,
total_revenue
from
supplier,
revenue{numRun}{STREAM}
where
s_suppkey = supplier_no
and total_revenue = (
select
max(total_revenue)
from
revenue{numRun}{STREAM}
)
order by
s_suppkey""",
"""drop view revenue{numRun}"""],
				'DB2': ["""create view revenue{numRun} as
select
l_suppkey supplier_no,
sum(l_extendedprice * (1 - l_discount)) total_revenue
from
lineitem
where
l_shipdate >= date '{DATE}'
and l_shipdate < date '{DATE}' + 3 month
group by
l_suppkey""",
"""select
s_suppkey,
s_name,
s_address,
s_phone,
total_revenue
from
supplier,
revenue{numRun}{STREAM}
where
s_suppkey = supplier_no
and total_revenue = (
select
max(total_revenue)
from
revenue{numRun}{STREAM}
)
order by
s_suppkey""",
"""drop view revenue{numRun}{STREAM}"""],
				'MySQL_view': ["""create view revenue{numRun}{STREAM} as
select
l_suppkey supplier_no,
sum(l_extendedprice * (1 - l_discount)) total_revenue
from
lineitem
where
l_shipdate >= date('{DATE}')
and l_shipdate < date('{DATE}') + interval '3' month
group by
l_suppkey""",
"""select
s_suppkey,
s_name,
s_address,
s_phone,
total_revenue
from
supplier,
revenue{numRun}{STREAM}
where
s_suppkey = supplier_no
and total_revenue = (
select
max(total_revenue)
from
revenue{numRun}{STREAM}
)
order by
s_suppkey""",
"""drop view revenue{numRun}{STREAM}"""],
				'TSQL': ["""create view revenue{numRun}{STREAM} as
select
l_suppkey supplier_no,
sum(l_extendedprice * (1 - l_discount)) total_revenue
from
lineitem
where
l_shipdate >= cast('{DATE}' as date)
and l_shipdate < dateadd(mm, +3, cast('{DATE}' as date))
group by
l_suppkey""",
"""select
s_suppkey,
s_name,
s_address,
s_phone,
total_revenue
from
supplier,
revenue{numRun}{STREAM}
where
s_suppkey = supplier_no
and total_revenue = (
select
max(total_revenue)
from
revenue{numRun}{STREAM}
)
order by
s_suppkey""",
"""drop view revenue{numRun}{STREAM}"""],
				'MonetDB': """with revenue (supplier_no, total_revenue) as (
select
l_suppkey,
sum(l_extendedprice * (1-l_discount))
from
lineitem
where
l_shipdate >= date '{DATE}'
and l_shipdate < date '{DATE}' + interval '3' month
group by
l_suppkey)
select
s_suppkey,
s_name,
s_address,
s_phone,
total_revenue
from
supplier,
revenue
where
s_suppkey = supplier_no
and total_revenue = (
select
max(total_revenue)
from
revenue
)
order by
s_suppkey""",
				'SAPHANA': ["""create view revenue{numRun}{STREAM} as
select
l_suppkey supplier_no,
sum(l_extendedprice * (1 - l_discount)) total_revenue
from
lineitem
where
l_shipdate >= to_date('{DATE}')
and l_shipdate < add_months(to_date('{DATE}'),3)
group by
l_suppkey""",
"""select
s_suppkey,
s_name,
s_address,
s_phone,
total_revenue
from
supplier,
revenue{numRun}{STREAM}
where
s_suppkey = supplier_no
and total_revenue = (
select
max(total_revenue)
from
revenue{numRun}{STREAM}
)
order by
s_suppkey""",
"""drop view revenue{numRun}{STREAM}"""],
			},
			'parameter': {
				'DATE': {
					'type': "firstofmonth",
					'range': ["1993-01-01","1997-10-01"]
				},
				'STREAM': {
					'type': "list",
					'range': [1]
				},
			},
			'active': True,
			'numWarmup': 0,
			'numCooldown': 0,
			'numRun': 1,
			'timer':
			{
				'datatransfer':
				{
					'active': False,
					'sorted': True,
					'compare': 'result',
					'store': [],
					'precision': 4,
				},
				'connection':
				{
					'active': True,
				}
			}
		},
		{
			'title': "Parts/Supplier Relationship (TPC-H Q16)",
			'query': """select
p_brand,
p_type,
p_size,
count(distinct ps_suppkey) as supplier_cnt
from
partsupp,
part
where
p_partkey = ps_partkey
and p_brand <> 'Brand#{BRAND1}{BRAND2}'
and p_type not like '{TYPE1}{TYPE2}{TYPE3}%'
and p_size in ({SIZE1}, {SIZE2}, {SIZE3}, {SIZE4}, {SIZE5}, {SIZE6}, {SIZE7}, {SIZE8})
and ps_suppkey not in (
select
s_suppkey
from
supplier
where
s_comment like '%Customer%Complaints%'
)
group by
p_brand,
p_type,
p_size
order by
supplier_cnt desc,
p_brand,
p_type,
p_size""",
			'parameter': {
				'SIZE': {
					'type': "integer",
					'size': 8,
					'range': [1,50]
				},
				'TYPE1': {
					'type': "list",
					'range': ["STANDARD", "SMALL", "MEDIUM", "LARGE", "ECONOMY", "PROMO"]
				},
				'TYPE2': {
					'type': "list",
					'range': [" ANODIZED", " BURNISHED", " PLATED", " POLISHED", " BRUSHED"]
				},
				'TYPE3': {
					'type': "list",
					'range': [" TIN", " NICKEL", " BRASS", " STEEL", " COPPER", ""]
				},
				'BRAND1': {
					'type': "integer",
					'range': [1,5]
				},
				'BRAND2': {
					'type': "integer",
					'range': [1,5]
				},
			},
			'active': True,
			'numWarmup': 0,
			'numCooldown': 0,
			'numRun': 1,
			'timer':
			{
				'datatransfer':
				{
					'active': True,
					'sorted': True,
					'compare': 'result',
					'store': [],
					'precision': 4,
				},
				'connection':
				{
					'active': True,
				}
			}
		},
		{
			'title': "Small-Quantity-Order Revenue (TPC-H Q17)",
			'query': """select
sum(l_extendedprice) / 7.0 as avg_yearly
from
lineitem,
part
where
p_partkey = l_partkey
and p_brand = 'Brand#{BRAND1}{BRAND2}'
and p_container = '{CONTAINER1} {CONTAINER2}'
and l_quantity < (
select
0.2 * avg(l_quantity)
from
lineitem
where
l_partkey = p_partkey
)""",
			'DBMS':{
				'OmniSci': """select
sum(li.l_extendedprice) / 7.0 as avg_yearly
from lineitem li
join part p on li.l_partkey = p.p_partkey
join
(
   select
   l_partkey,
   0.2 * avg(l_quantity) as quantity
   from lineitem
   group by l_partkey
)
as quantities on li.l_partkey = quantities.l_partkey
and li.l_quantity < quantities.quantity
where p.p_brand = 'Brand#{BRAND1}{BRAND2}'
and p.p_container = '{CONTAINER1} {CONTAINER2}'""",
				'MariaDBCS': """select
sum(li.l_extendedprice) / 7.0 as avg_yearly
from lineitem li
join part p on li.l_partkey = p.p_partkey
join
(
   select
   l_partkey,
   0.2 * avg(l_quantity) as quantity
   from lineitem
   group by l_partkey
)
as quantities on li.l_partkey = quantities.l_partkey
and li.l_quantity < quantities.quantity
where p.p_brand = 'Brand#{BRAND1}{BRAND2}'
and p.p_container = '{CONTAINER1} {CONTAINER2}'""",
				'Clickhouse': """select
cast(sum(li.l_extendedprice) as DECIMAL(16,2)) / cast(7.00 as decimal(16,2)) as avg_yearly
from lineitem li
join part p on li.l_partkey = p.p_partkey
join
(
   select
   l_partkey,
   CAST(0.2 * avg(l_quantity) AS DECIMAL(16,2)) as quantity
   from lineitem
   group by l_partkey
)
as quantities on li.l_partkey = quantities.l_partkey
where p.p_brand = 'Brand#{BRAND1}{BRAND2}'
and li.l_quantity < quantities.quantity
and p.p_container = '{CONTAINER1} {CONTAINER2}'""",
				'Citus': """select
sum(li.l_extendedprice) / 7.0 as avg_yearly
from lineitem li
join part p on li.l_partkey = p.p_partkey
join
(
   select
   l_partkey,
   0.2 * avg(l_quantity) as quantity
   from lineitem
   group by l_partkey
)
as quantities on li.l_partkey = quantities.l_partkey
and li.l_quantity < quantities.quantity
where p.p_brand = 'Brand#{BRAND1}{BRAND2}'
and p.p_container = '{CONTAINER1} {CONTAINER2}'""",
			},
			'parameter': {
				'CONTAINER1': {
					'type': "list",
					'range': ["SM", "LG", "MED", "JUMBO", "WRAP"]
				},
				'CONTAINER2': {
					'type': "list",
					'range': ["CASE", "BOX", "BAG", "JAR", "PKG", "PACK"]
				},
				'BRAND1': {
					'type': "integer",
					'range': [1,5]
				},
				'BRAND2': {
					'type': "integer",
					'range': [1,5]
				},
			},
			'active': True,
			'numWarmup': 0,
			'numCooldown': 0,
			'numRun': 1,
			'timer':
			{
				'datatransfer':
				{
					'active': True,
					'sorted': True,
					'compare': 'result',
					'store': [],
					'precision': 1,
				},
				'connection':
				{
					'active': True,
				}
			}
		},
		{
			'title': "Large Volume Customer (TPC-H Q18)",
			'query': """select
c_name,
c_custkey,
o_orderkey,
o_orderdate,
o_totalprice,
cast(sum(l_quantity) as int) as sum_quant
from
customer,
orders,
lineitem
where
o_orderkey in (
select
l_orderkey
from
lineitem
group by
l_orderkey having
sum(l_quantity) > {QUANTITY}
)
and c_custkey = o_custkey
and o_orderkey = l_orderkey
group by
c_name,
c_custkey,
o_orderkey,
o_orderdate,
o_totalprice
order by
o_totalprice desc,
o_orderdate
limit 100""",
			'DBMS':{
				'MySQL': """select
c_name,
c_custkey,
o_orderkey,
o_orderdate,
o_totalprice,
cast(sum(l_quantity) as unsigned integer) as sum_quant
from
customer,
orders,
lineitem
where
o_orderkey in (
select
l_orderkey
from
lineitem
group by
l_orderkey having
sum(l_quantity) > {QUANTITY}
)
and c_custkey = o_custkey
and o_orderkey = l_orderkey
group by
c_name,
c_custkey,
o_orderkey,
o_orderdate,
o_totalprice
order by
o_totalprice desc,
o_orderdate
limit 100""",
				'TSQL': """select top 100
c_name,
c_custkey,
o_orderkey,
o_orderdate,
o_totalprice,
cast(sum(l_quantity) as int) as sum_quant
from
customer,
orders,
lineitem
where
o_orderkey in (
select
l_orderkey
from
lineitem
group by
l_orderkey having
sum(l_quantity) > {QUANTITY}
)
and c_custkey = o_custkey
and o_orderkey = l_orderkey
group by
c_name,
c_custkey,
o_orderkey,
o_orderdate,
o_totalprice
order by
o_totalprice desc,
o_orderdate""",
				'Oracle': """select
c_name,
c_custkey,
o_orderkey,
o_orderdate,
o_totalprice,
cast(sum(l_quantity) as int) as sum_quant
from
customer,
orders,
lineitem
where
o_orderkey in (
select
l_orderkey
from
lineitem
group by
l_orderkey having
sum(l_quantity) > {QUANTITY}
)
and c_custkey = o_custkey
and o_orderkey = l_orderkey
group by
c_name,
c_custkey,
o_orderkey,
o_orderdate,
o_totalprice
order by
o_totalprice desc,
o_orderdate
fetch next 100 rows only""",
			},
			'parameter': {
				'QUANTITY': {
					'type': "integer",
					'range': [312, 315]
				},
			},
			'active': True,
			'numWarmup': 0,
			'numCooldown': 0,
			'numRun': 1,
			'timer':
			{
				'datatransfer':
				{
					'active': True,
					'sorted': True,
					'compare': 'result',
					'store': [],
					'precision': 4,
				},
				'connection':
				{
					'active': True,
				}
			}
		},
		{
			'title': "Discounted Revenue (TPC-H Q19)",
			'query': """select
sum(l_extendedprice * (1 - l_discount) ) as revenue
from
lineitem,
part
where
(
p_partkey = l_partkey
and p_brand = 'Brand#{BRAND11}{BRAND12}'
and p_container in ( 'SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
and l_quantity >= {QUANTITY1} and l_quantity <= {QUANTITY1} + 10
and p_size between 1 and 5
and l_shipmode in ('AIR', 'AIR REG')
and l_shipinstruct = 'DELIVER IN PERSON'
)
or
(
p_partkey = l_partkey
and p_brand = 'Brand#{BRAND21}{BRAND22}'
and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
and l_quantity >= {QUANTITY2} and l_quantity <= {QUANTITY2} + 10
and p_size between 1 and 10
and l_shipmode in ('AIR', 'AIR REG')
and l_shipinstruct = 'DELIVER IN PERSON'
)
or
(
p_partkey = l_partkey
and p_brand = 'Brand#{BRAND31}{BRAND32}'
and p_container in ( 'LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
and l_quantity >= {QUANTITY3} and l_quantity <= {QUANTITY3} + 10
and p_size between 1 and 15
and l_shipmode in ('AIR', 'AIR REG')
and l_shipinstruct = 'DELIVER IN PERSON')""",
			'DBMS':{
				'MariaDBCS': """select
sum(l_extendedprice * (1 - l_discount) ) as revenue
from
lineitem,
part
where
p_partkey = l_partkey
and ((
p_brand = 'Brand#{BRAND11}{BRAND12}'
and p_container in ( 'SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
and l_quantity >= {QUANTITY1} and l_quantity <= {QUANTITY1} + 10
and p_size between 1 and 5
and l_shipmode in ('AIR', 'AIR REG')
and l_shipinstruct = 'DELIVER IN PERSON'
)
or
(
p_brand = 'Brand#{BRAND21}{BRAND22}'
and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
and l_quantity >= {QUANTITY2} and l_quantity <= {QUANTITY2} + 10
and p_size between 1 and 10
and l_shipmode in ('AIR', 'AIR REG')
and l_shipinstruct = 'DELIVER IN PERSON'
)
or
(
p_brand = 'Brand#{BRAND31}{BRAND32}'
and p_container in ( 'LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
and l_quantity >= {QUANTITY3} and l_quantity <= {QUANTITY3} + 10
and p_size between 1 and 15
and l_shipmode in ('AIR', 'AIR REG')
and l_shipinstruct = 'DELIVER IN PERSON'))""",
			},
			'parameter': {
				'QUANTITY1': {
					'type': "integer",
					'range': [1,10]
				},
				'QUANTITY2': {
					'type': "integer",
					'range': [10,20]
				},
				'QUANTITY3': {
					'type': "integer",
					'range': [20,30]
				},
				'BRAND11': {
					'type': "integer",
					'range': [1,5]
				},
				'BRAND12': {
					'type': "integer",
					'range': [1,5]
				},
				'BRAND21': {
					'type': "integer",
					'range': [1,5]
				},
				'BRAND22': {
					'type': "integer",
					'range': [1,5]
				},
				'BRAND31': {
					'type': "integer",
					'range': [1,5]
				},
				'BRAND32': {
					'type': "integer",
					'range': [1,5]
				},
			},
			'active': True,
			'numWarmup': 0,
			'numCooldown': 0,
			'numRun': 1,
			'timer':
			{
				'datatransfer':
				{
					'active': True,
					'sorted': True,
					'compare': 'result',
					'store': [],
					'precision': 4,
				},
				'connection':
				{
					'active': True,
				}
			}
		},
		{
			'title': "Potential Part Promotion (TPC-H Q20)",
			'query': """select
s_name,
s_address
from
supplier, nation
where
s_suppkey in (
select
ps_suppkey
from
partsupp
where
ps_partkey in (
select
p_partkey
from
part
where
p_name like '{COLOR}%'
)
and ps_availqty > (
select
0.5 * sum(l_quantity)
from
lineitem
where
l_partkey = ps_partkey
and l_suppkey = ps_suppkey
and l_shipdate >= date '{DATE}'
and l_shipdate < date '{DATE}' + interval '1' year
)
)
and s_nationkey = n_nationkey
and n_name = '{NATION}'
order by
s_name""",
			'DBMS':{
				'MySQL': """select
s_name,
s_address
from
supplier, nation
where
s_suppkey in (
select
ps_suppkey
from
partsupp
where
ps_partkey in (
select
p_partkey
from
part
where
p_name like '{COLOR}%'
)
and ps_availqty > (
select
0.5 * sum(l_quantity)
from
lineitem
where
l_partkey = ps_partkey
and l_suppkey = ps_suppkey
and l_shipdate >= date('{DATE}')
and l_shipdate < date('{DATE}') + interval '1' year
)
)
and s_nationkey = n_nationkey
and n_name = '{NATION}'
order by
s_name""",
				'TSQL': """select
s_name,
s_address
from
supplier, nation
where
s_suppkey in (
select
ps_suppkey
from
partsupp
where
ps_partkey in (
select
p_partkey
from
part
where
p_name like '{COLOR}%'
)
and ps_availqty > (
select
0.5 * sum(l_quantity)
from
lineitem
where
l_partkey = ps_partkey
and l_suppkey = ps_suppkey
and l_shipdate >= cast('{DATE}' as date)
and l_shipdate < dateadd(yy, +1, cast('{DATE}' as date))
)
)
and s_nationkey = n_nationkey
and n_name = '{NATION}'
order by
s_name""",
				'OmniSci': """with corrsq as (
select l_partkey,l_suppkey
,0.5 * sum(l_quantity) sum_subq
from
lineitem
where
l_shipdate >= date '{DATE}'
and l_shipdate < date '{DATE}' + interval '1' year
group by 1,2
)
select
s_name,
s_address
from
supplier, nation
where
s_suppkey in (
select
distinct ps_suppkey
from
partsupp join corrsq
on
corrsq.l_partkey = ps_partkey
and corrsq.l_suppkey = ps_suppkey
where
ps_partkey in (
select
distinct p_partkey
from
part
where
p_name like '{COLOR}%'
)
and ps_availqty > corrsq.sum_subq
)
and s_nationkey = n_nationkey
and n_name = '{NATION}'
order by
s_name""",
				'Citus': """with corrsq as (
select l_partkey,l_suppkey
,0.5 * sum(l_quantity) sum_subq
from
lineitem
where
l_shipdate >= date '{DATE}'
and l_shipdate < date '{DATE}' + interval '1' year
group by 1,2
)
select
s_name,
s_address
from
supplier, nation
where
s_suppkey in (
select
distinct ps_suppkey
from
partsupp join corrsq
on
corrsq.l_partkey = ps_partkey
and corrsq.l_suppkey = ps_suppkey
where
ps_partkey in (
select
distinct p_partkey
from
part
where
p_name like '{COLOR}%'
)
and ps_availqty > corrsq.sum_subq
)
and s_nationkey = n_nationkey
and n_name = '{NATION}'
order by
s_name""",
				'SAPHANA': """select
s_name,
s_address
from
supplier, nation
where
s_suppkey in (
select
ps_suppkey
from
partsupp
where
ps_partkey in (
select
p_partkey
from
part
where
p_name like '{COLOR}%'
)
and ps_availqty > (
select
0.5 * sum(l_quantity)
from
lineitem
where
l_partkey = ps_partkey
and l_suppkey = ps_suppkey
and l_shipdate >= to_date('{DATE}')
and l_shipdate < add_years(to_date('{DATE}'),1)
)
)
and s_nationkey = n_nationkey
and n_name = '{NATION}'
order by
s_name""",
				'Clickhouse': """with corrsq as (
select l_partkey,l_suppkey
,0.5 * sum(l_quantity) sum_subq
from
lineitem
where
l_shipdate >= toDate('{DATE}')
and l_shipdate < addYears(toDate('{DATE}'),1)
group by l_partkey,l_suppkey
)
select
s_name,
s_address
from
supplier, nation
where
s_suppkey in (
select
distinct ps_suppkey
from
partsupp join corrsq
on
corrsq.l_partkey = ps_partkey
and corrsq.l_suppkey = ps_suppkey
where
ps_partkey in (
select
distinct p_partkey
from
part
where
p_name like '{COLOR}%'
)
and ps_availqty > corrsq.sum_subq
)
and s_nationkey = n_nationkey
and n_name = '{NATION}'
order by
s_name""",
				'DB2': """select
s_name,
s_address
from
supplier, nation
where
s_suppkey in (
select
ps_suppkey
from
partsupp
where
ps_partkey in (
select
p_partkey
from
part
where
p_name like '{COLOR}%'
)
and ps_availqty > (
select
0.5 * sum(l_quantity)
from
lineitem
where
l_partkey = ps_partkey
and l_suppkey = ps_suppkey
and l_shipdate >= date '{DATE}'
and l_shipdate < date '{DATE}' + 1 year
)
)
and s_nationkey = n_nationkey
and n_name = '{NATION}'
order by
s_name""",
			},
			'parameter': {
				'DATE': {
					'type': "firstofyear",
					'range': [1993, 1997]
				},
				'NATION': {
					'type': "list",
					'range': ["ALGERIA","ARGENTINA","BRAZIL","CANADA","INDIA","INDONESIA","IRAN","IRAQ","MOZAMBIQUE","PERU","CHINA","ROMANIA","UNITED STATES","EGYPT","ETHIOPIA","FRANCE","GERMANY","JAPAN","JORDAN","KENYA","MOROCCO","SAUDI ARABIA","VIETNAM","RUSSIA","UNITED KINGDOM"]
				},
				'COLOR': {
					'type': "list",
					'range': ["almond", "antique", "aquamarine", "azure", "beige", "bisque", "black", "blanched", "blue", "blush", "brown", "burlywood", "burnished", "chartreuse", "chiffon", "chocolate", "coral", "cornflower", "cornsilk", "cream", "cyan", "dark", "deep", "dim", "dodger", "drab", "firebrick", "floral", "forest", "frosted", "gainsboro", "ghost", "goldenrod", "green", "grey", "honeydew", "hot", "indian", "ivory", "khaki", "lace", "lavender", "lawn", "lemon", "light", "lime", "linen", "magenta", "maroon", "medium", "metallic", "midnight", "mint", "misty", "moccasin", "navajo", "navy", "olive", "orange", "orchid", "pale", "papaya", "peach", "peru", "pink", "plum", "powder", "puff", "purple", "red", "rose", "rosy", "royal", "saddle", "salmon", "sandy", "seashell", "sienna", "sky", "slate", "smoke", "snow", "spring", "steel", "tan", "thistle", "tomato", "turquoise", "violet", "wheat", "white", "yellow"]
				},
			},
			'active': True,
			'numWarmup': 0,
			'numCooldown': 0,
			'numRun': 1,
			'timer':
			{
				'datatransfer':
				{
					'active': True,
					'sorted': True,
					'compare': 'result',
					'store': [],
					'precision': 4,
				},
				'connection':
				{
					'active': True,
				}
			}
		},
		{
			'title': "Suppliers Who Kept Orders Waiting Query (TPC-H Q21)",
			'query': """select
s_name,
count(*) as numwait
from
supplier,
lineitem l1,
orders,
nation
where
s_suppkey = l1.l_suppkey
and o_orderkey = l1.l_orderkey
and o_orderstatus = 'F'
and l1.l_receiptdate > l1.l_commitdate
and exists (
select
*
from
lineitem l2
where
l2.l_orderkey = l1.l_orderkey
and l2.l_suppkey <> l1.l_suppkey
)
and not exists (
select
*
from
lineitem l3
where
l3.l_orderkey = l1.l_orderkey
and l3.l_suppkey <> l1.l_suppkey
and l3.l_receiptdate > l3.l_commitdate
)
and s_nationkey = n_nationkey
and n_name = '{NATION}'
group by
s_name
order by
numwait desc,
s_name
limit 100""",
			'DBMS':{
				'TSQL': """select top 100
s_name,
count(*) as numwait
from
supplier,
lineitem l1,
orders,
nation
where
s_suppkey = l1.l_suppkey
and o_orderkey = l1.l_orderkey
and o_orderstatus = 'F'
and l1.l_receiptdate > l1.l_commitdate
and exists (
select
*
from
lineitem l2
where
l2.l_orderkey = l1.l_orderkey
and l2.l_suppkey <> l1.l_suppkey
)
and not exists (
select
*
from
lineitem l3
where
l3.l_orderkey = l1.l_orderkey
and l3.l_suppkey <> l1.l_suppkey
and l3.l_receiptdate > l3.l_commitdate
)
and s_nationkey = n_nationkey
and n_name = '{NATION}'
group by
s_name
order by
numwait desc,
s_name""",
				'Oracle': """select
s_name,
count(*) as numwait
from
supplier,
lineitem l1,
orders,
nation
where
s_suppkey = l1.l_suppkey
and o_orderkey = l1.l_orderkey
and o_orderstatus = 'F'
and l1.l_receiptdate > l1.l_commitdate
and exists (
select
*
from
lineitem l2
where
l2.l_orderkey = l1.l_orderkey
and l2.l_suppkey <> l1.l_suppkey
)
and not exists (
select
*
from
lineitem l3
where
l3.l_orderkey = l1.l_orderkey
and l3.l_suppkey <> l1.l_suppkey
and l3.l_receiptdate > l3.l_commitdate
)
and s_nationkey = n_nationkey
and n_name = '{NATION}'
group by
s_name
order by
numwait desc,
s_name
fetch next 100 rows only""",
			},
			'parameter': {
				'NATION': {
					'type': "list",
					'range': ["ALGERIA","ARGENTINA","BRAZIL","CANADA","INDIA","INDONESIA","IRAN","IRAQ","MOZAMBIQUE","PERU","CHINA","ROMANIA","UNITED STATES","EGYPT","ETHIOPIA","FRANCE","GERMANY","JAPAN","JORDAN","KENYA","MOROCCO","SAUDI ARABIA","VIETNAM","RUSSIA","UNITED KINGDOM"]
				},
			},
			'active': True,
			'numWarmup': 0,
			'numCooldown': 0,
			'numRun': 1,
			'timer':
			{
				'datatransfer':
				{
					'active': True,
					'sorted': True,
					'compare': 'result',
					'store': [],
					'precision': 4,
				},
				'connection':
				{
					'active': True,
				}
			}
		},
		{
			'title': "Global Sales Opportunity Query (TPC-H Q22)",
			'query': """select
cntrycode,
count(*) as numcust,
sum(c_acctbal) as totacctbal
from (
select
substring(c_phone from 1 for 2) as cntrycode,
c_acctbal
from
customer
where
substring(c_phone from 1 for 2) in
('{I1}','{I2}','{I3}','{I4}','{I5}','{I6}','{I7}')
and c_acctbal > (
select
avg(c_acctbal)
from
customer
where
c_acctbal > 0.00
and substring(c_phone from 1 for 2) in
('{I1}','{I2}','{I3}','{I4}','{I5}','{I6}','{I7}')
)
and not exists (
select
*
from
orders
where
o_custkey = c_custkey
)
) as custsale
group by
cntrycode
order by
cntrycode""",
			'DBMS':{
				'TSQL': """select
cntrycode,
count(*) as numcust,
sum(c_acctbal) as totacctbal
from (
select
substring(c_phone, 1, 2) as cntrycode,
c_acctbal
from
customer
where
substring(c_phone, 1, 2) in
('{I1}','{I2}','{I3}','{I4}','{I5}','{I6}','{I7}')
and c_acctbal > (
select
avg(c_acctbal)
from
customer
where
c_acctbal > 0.00
and substring(c_phone, 1, 2) in
('{I1}','{I2}','{I3}','{I4}','{I5}','{I6}','{I7}')
)
and not exists (
select
*
from
orders
where
o_custkey = c_custkey
)
) as custsale
group by
cntrycode
order by
cntrycode""",
				'Oracle': """select
cntrycode,
count(*) as numcust,
sum(c_acctbal) as totacctbal
from (
select
substr(c_phone, 1, 2) as cntrycode,
c_acctbal
from
customer
where
substr(c_phone, 1, 2) in
('{I1}','{I2}','{I3}','{I4}','{I5}','{I6}','{I7}')
and c_acctbal > (
select
avg(c_acctbal)
from
customer
where
c_acctbal > 0.00
and substr(c_phone, 1, 2) in
('{I1}','{I2}','{I3}','{I4}','{I5}','{I6}','{I7}')
)
and not exists (
select
*
from
orders
where
o_custkey = c_custkey
)
) custsale
group by
cntrycode
order by
cntrycode""",
				'SAPHANA': """select
cntrycode,
count(*) as numcust,
sum(c_acctbal) as totacctbal
from (
select
substr(c_phone, 1, 2) as cntrycode,
c_acctbal
from
customer
where
substr(c_phone, 1, 2) in
('{I1}','{I2}','{I3}','{I4}','{I5}','{I6}','{I7}')
and c_acctbal > (
select
avg(c_acctbal)
from
customer
where
c_acctbal > 0.00
and substr(c_phone, 1, 2) in
('{I1}','{I2}','{I3}','{I4}','{I5}','{I6}','{I7}')
)
and not exists (
select
*
from
orders
where
o_custkey = c_custkey
)
) custsale
group by
cntrycode
order by
cntrycode""",
			},
			'parameter': {
				'I': {
					'type': "integer",
					'size': 7,
					'range': [10,34]
				},
			},
			'active': True,
			'numWarmup': 0,
			'numCooldown': 0,
			'numRun': 1,
			'timer':
			{
				'datatransfer':
				{
					'active': True,
					'sorted': True,
					'compare': 'result',
					'store': [],
					'precision': 4,
				},
				'connection':
				{
					'active': True,
				}
			}
		},
	]
}